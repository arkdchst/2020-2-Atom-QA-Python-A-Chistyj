## Итоговый проект
*Работу выполнил Аркадий Чистый*

### Структура проекта:

#### Общая структура проекта:

* `Jenkins`
	* `myapp_system` - `docker-compose` сборка из приложения, базы данных, мока VK API
		* `myapp`
		* `myapp_db` - изображение с Percona Server
		* `vkapi`
	* `selenoid`
	* `test_system` - образ, тестирующий `myapp`

#### Структура файлов:

```
.
├── docker-compose.yml - файл docker-compose для myapp_system
├── Jenkinsfile
├── myapp/
│   ├── config
│   └── wait_for_db/ - скрипты для ожидания запуска БД
├── myapp_db/
│   └── init.sql - скрипт инициализации базы
├── README.md - файл, который вы читаете
├── selenoid/
│   ├── config/
│   └── start.sh* - запуск docker-образа с selenoid
├── test_system/
│   ├── Dockerfile
│   ├── requirements
│   ├── start.sh* - запуск docker-образа test_system
│   ├── tests/
│   └── wait_for_myapp.sh* - скрипт для ожидания запуска myapp
└── vkapi/
    ├── Dockerfile
    └── vkapi.py
```

Jenkins запускает последовательно `myapp_system`, `selenoid`, `test_system`, затем генерирует отчёт в Allure. Все docker-контейнеры проброшены в одну сеть с названием `myapp` и видят друг друга.

Все тесты имеют описание в docstring. Если какой-то web-тест падает, к отчёту allure прикрепляется скриншот браузера.

### Найденные баги:

* web
	* при вводе невалидного имени и невалидного пароля страница входа выдаёт ошибку в формате JSON

	  ***ожидалось:** ошибка в любом user-friendly формате*

	* после регистрации и попадания на главную страницу поля `active` и `start_active_time` в базе не изменяются

	  ***ожидалось:** после регистрации поле `active` и `start_active_time` изменяются как после входа в систему*

	* приложение позволяет регистрироваться с пробелами в имени и пароле

	* если пользователь с email уже существует форма регистрации выдаёт ошибку `Internal Server Error`

	  ***ожидалось:** ошибка в духе "Пользователь с этим email уже существует"*

	* если `VK ID = 0`, то он не отображается в интерфейсе приложения

	* если `VK ID` слишком длинный, он задевает oменю на странице

	  ***ожидалось:** ограничение ширины поля `VK ID` переносом, либо пропуском части символов*

	* при блокировке пользователя с `active=1` это поле не изменяется

	  ***ожидалось:** после блокировки поле `active` устанавливается в `0`*

	* приложение не позволяет ввести email с точкой в конце: `my@example.com.`

* API
	* при успешных операциях API возвращает код 210 (далее *OK*)

	  ***ожидалось:** вовзрат кода 201, как указано в документации к приложению*

	* при попытке добавления пользователя с таким же email API возвращает *OK*

	* при добавлении пользователей поля не валидируются
